<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Spin the Wheel</title>

<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    height: 100vh;
    background: #000;
    color: #fff;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  h1 { margin: 10px 0; }

  /* Mascot */
  .mascot {
    position: fixed;
    top: 10px;
    right: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 10;
  }

  .mascot-img {
    font-size: 48px;
    animation: wave 1s infinite alternate;
    transform-origin: 70% 70%;
  }

  @keyframes wave {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(20deg); }
    100% { transform: rotate(-20deg); }
  }

  .speech-bubble {
    background: #fff;
    color: #000;
    font-size: 14px;
    padding: 8px 12px;
    border-radius: 10px;
    max-width: 200px;
    text-align: center;
    margin-bottom: 6px;
    position: relative;
  }

  .speech-bubble::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    border-width: 8px;
    border-style: solid;
    border-color: #fff transparent transparent transparent;
  }

  /* Wheel */
  .wheel-container {
    position: relative;
    width: 380px;
    height: 380px;
    margin: 30px 0;
  }

  .wheel {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 10px solid #ddd;
    position: relative;
    overflow: hidden;
    transition: transform 5.8s cubic-bezier(0.12, 0.82, 0.08, 1);
    background: conic-gradient(
      #b0ffb0 0deg 51.4286deg,
      #b084ff 51.4286deg 102.8571deg,
      gold      102.8571deg 154.2857deg,
      #ff4d4d   154.2857deg 205.7143deg,
      #00ffff   205.7143deg 257.1429deg,
      #ff00ff   257.1429deg 308.5714deg,
      #555555   308.5714deg 360deg
    );
  }

  .pointer {
    position: absolute;
    top: -24px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 16px solid transparent;
    border-right: 16px solid transparent;
    border-bottom: 32px solid red;
    z-index: 5;
  }

  .labels {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .labels div {
    position: absolute;
    left: 50%;
    top: 50%;
    transform-origin: center 140px;   /* distance from center ‚Äî adjust if needed */
    font-weight: bold;
    font-size: 15px;
    color: #000;
    text-shadow: 0 0 3px rgba(255,255,255,0.9);
    white-space: nowrap;
    text-align: center;
    width: 140px;
    margin-left: -70px;               /* center the label horizontally */
  }

  /* Position each label by rotation */
  .labels div:nth-child(1) { transform: translate(-50%, -50%) rotate(25.714deg); }
  .labels div:nth-child(2) { transform: translate(-50%, -50%) rotate(77.143deg); }
  .labels div:nth-child(3) { transform: translate(-50%, -50%) rotate(128.571deg); }
  .labels div:nth-child(4) { transform: translate(-50%, -50%) rotate(180deg);     }
  .labels div:nth-child(5) { transform: translate(-50%, -50%) rotate(231.429deg); }
  .labels div:nth-child(6) { transform: translate(-50%, -50%) rotate(282.857deg); }
  .labels div:nth-child(7) { transform: translate(-50%, -50%) rotate(334.286deg); }

  button {
    margin: 12px;
    padding: 14px 50px;
    font-size: 20px;
    font-weight: bold;
    border: none;
    border-radius: 12px;
    background: #ff004f;
    color: white;
    cursor: pointer;
  }

  .result {
    font-size: 24px;
    min-height: 36px;
    margin: 10px 0;
  }

  .common    { color:#b0ffb0; text-shadow:0 0 10px #b0ffb0; }
  .rare      { color:#b084ff; text-shadow:0 0 14px #b084ff; }
  .legendary { color:gold;    text-shadow:0 0 16px gold, 0 0 32px orange; animation: pulse 1.4s infinite alternate; }
  .death-glow{ color:#ff4d4d; text-shadow:0 0 20px red, 0 0 40px darkred; animation: breathe 1.6s infinite; }

  @keyframes pulse  { from {text-shadow:0 0 16px gold}     to {text-shadow:0 0 40px orange} }
  @keyframes breathe{ 0%,100%{opacity:0.7} 50%{opacity:1} }

  .death { animation: shake 0.5s infinite; background: #8b0000; }

  @keyframes shake {
    0%,100% { transform: translate(0); }
    25%  { transform: translate(-6px, 4px); }
    50%  { transform: translate(6px, -4px); }
    75%  { transform: translate(-4px, -6px); }
  }

  .money {
    position: absolute;
    top: -60px;
    font-size: 28px;
    animation: fall linear forwards;
    pointer-events: none;
  }

  @keyframes fall { to { transform: translateY(120vh); } }

  .history, .leaderboard {
    width: 90%;
    max-width: 360px;
    max-height: 140px;
    overflow-y: auto;
    font-size: 15px;
    border-top: 1px solid #444;
    margin-top: 8px;
    padding-top: 8px;
  }

  .slider { margin: 10px 0; font-size: 15px; }
</style>
</head>
<body>

<div class="mascot">
  <div class="speech-bubble">
    Spin it! Maybe you'll get rich... or maybe not üòà
  </div>
  <div class="mascot-img">üë©‚Äçüé§</div>
</div>

<h1>Spin the Wheel</h1>

<div class="slider">
  Death Probability: <span id="deathValue">5</span>%
  <input type="range" min="1" max="30" value="5" id="deathSlider">
</div>

<div class="wheel-container">
  <div class="pointer"></div>
  <div class="wheel" id="wheel">
    <div class="labels">
      <div>500k ‚Ç¨</div>
      <div>1 Mio ‚Ç¨</div>
      <div>10 Mio ‚Ç¨</div>
      <div>100 Mio ‚Ç¨</div>
      <div>1 Bil ‚Ç¨</div>
      <div>10 Bil ‚Ç¨</div>
      <div>üíÄ Death</div>
    </div>
  </div>
</div>

<button onclick="spin()">SPIN</button>

<div class="result" id="result"></div>
<div class="history" id="history"></div>
<div class="leaderboard" id="leaderboard"></div>

<!-- Sounds -->
<audio id="spinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-fast-small-sweep-transition-166.wav"></audio>
<audio id="tickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-mechanical-bling-210.wav"></audio>
<audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.wav"></audio>
<audio id="deathSound" src="https://assets.mixkit.co/sfx/preview/mixkit-creepy-ambience-1910.wav"></audio>

<script>
const outcomes = ["500k ‚Ç¨", "1 Mio ‚Ç¨", "10 Mio ‚Ç¨", "100 Mio ‚Ç¨", "1 Bil ‚Ç¨", "10 Bil ‚Ç¨", "üíÄ Death"];
const historyEl    = document.getElementById("history");
const leaderboardEl = document.getElementById("leaderboard");
const resultEl     = document.getElementById("result");
const slider       = document.getElementById("deathSlider");
const deathValue   = document.getElementById("deathValue");
const wheel        = document.getElementById("wheel");
const tickSound    = document.getElementById("tickSound");

slider.oninput = () => deathValue.textContent = slider.value;

let rotation = 0;

function vibrate(p) { navigator.vibrate?.(p); }

function classify(outcome) {
  if (outcome.includes("Death")) return "death-glow";
  if (outcome.includes("Bil"))   return "legendary";
  if (outcome.includes("100"))   return "rare";
  return "common";
}

function moneyRain() {
  for (let i = 0; i < 24; i++) {
    const m = document.createElement("div");
    m.className = "money";
    m.textContent = "üí∞";
    m.style.left = Math.random() * 100 + "vw";
    m.style.animationDuration = (Math.random() * 2 + 2.5) + "s";
    document.body.appendChild(m);
    setTimeout(() => m.remove(), 5000);
  }
}

function updateLeaderboard(outcome) {
  const data = JSON.parse(localStorage.getItem("leaderboard") || "{}");
  data[outcome] = (data[outcome] || 0) + 1;
  localStorage.setItem("leaderboard", JSON.stringify(data));
  leaderboardEl.innerHTML = "<b>Leaderboard</b><br>" +
    Object.entries(data).sort((a,b)=>b[1]-a[1])
      .map(([k,v]) => `${k}: ${v}`).join("<br>");
}

function spin() {
  resultEl.className = "result";
  document.body.classList.remove("death");
  document.getElementById("spinSound").play();
  vibrate([100,50,100]);

  let ticks = 0;
  const tickInterval = setInterval(() => {
    tickSound.currentTime = 0;
    tickSound.play();
    ticks++;
    if (ticks > 12) clearInterval(tickInterval);
  }, 220);

  // Decide outcome
  let outcome;
  if (Math.random() * 100 < slider.value) {
    outcome = "üíÄ Death";
  } else {
    outcome = outcomes[Math.floor(Math.random() * 6)];
  }

  // Calculate rotation ‚Äî lands in the middle of the segment
  const sliceDeg = 360 / 7;
  const index = outcomes.indexOf(outcome);
  const midSegment = index * sliceDeg + sliceDeg / 2;
  const spins = 5 + Math.random() * 2;           // 5‚Äì7 full spins
  const targetRotation = 360 * spins + 90 - midSegment; // 90¬∞ offset because pointer is at top

  rotation += targetRotation - (rotation % 360); // normalize

  wheel.style.transform = `rotate(${rotation}deg)`;

  setTimeout(() => {
    if (outcome.includes("Death")) {
      document.body.classList.add("death");
      document.getElementById("deathSound").play();
      vibrate([300,100,300,100,300]);
    } else {
      document.getElementById("winSound").play();
      vibrate([120,60,120]);
      if (outcome.includes("Bil") || outcome.includes("100")) moneyRain();
    }

    const rarity = classify(outcome);
    resultEl.textContent = "Result: " + outcome;
    resultEl.classList.add(rarity);
    historyEl.innerHTML = `‚Ä¢ ${outcome}<br>` + historyEl.innerHTML.slice(0, 800);
    updateLeaderboard(outcome);
  }, 5800);
}

updateLeaderboard("‚Äî");
</script>
</body>
</html>
