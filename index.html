<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Spin the Wheel</title>

<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    height: 100vh;
    background: #000;
    color: #fff;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  h1 { margin: 10px 0; }

  /* ===== Mascot ===== */
  .mascot {
    position: fixed;
    top: 10px;
    right: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 10;
  }

  .mascot-img {
    font-size: 48px;
    animation: wave 1s infinite alternate;
    transform-origin: 70% 70%;
    cursor: default;
  }

  @keyframes wave {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(20deg); }
    100% { transform: rotate(-20deg); }
  }

  .speech-bubble {
    background: #fff;
    color: #000;
    font-size: 14px;
    padding: 8px 12px;
    border-radius: 10px;
    max-width: 200px;
    text-align: center;
    margin-bottom: 6px;
    position: relative;
  }

  .speech-bubble::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    border-width: 8px;
    border-style: solid;
    border-color: #fff transparent transparent transparent;
  }

  /* ===== Wheel ===== */
  .wheel-container {
    position: relative;
    width: 360px;
    height: 360px;
    margin-top: 40px;
  }

  .wheel {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 8px solid #fff;
    position: relative;
    overflow: hidden;
    transition: transform 5.8s cubic-bezier(.12,.82,.08,1);
  }

  .wheel .labels {
    position: absolute;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
  }

  .wheel .labels div {
    position: absolute;
    width: 140px;
    text-align: center;
    font-weight: bold;
    font-size: 14px;
    color: #000;
    transform-origin: 50% 180px; /* push labels inside wheel */
  }

  .wheel .labels div:nth-child(1) { transform: rotate(0deg); }
  .wheel .labels div:nth-child(2) { transform: rotate(51.43deg); }
  .wheel .labels div:nth-child(3) { transform: rotate(102.86deg); }
  .wheel .labels div:nth-child(4) { transform: rotate(154.29deg); }
  .wheel .labels div:nth-child(5) { transform: rotate(205.72deg); }
  .wheel .labels div:nth-child(6) { transform: rotate(257.15deg); }
  .wheel .labels div:nth-child(7) { transform: rotate(308.58deg); }

  /* 7 distinct colors using conic-gradient */
  .wheel {
    background: conic-gradient(
      #b0ffb0 0deg 51.43deg,
      #b084ff 51.43deg 102.86deg,
      gold 102.86deg 154.29deg,
      #ff4d4d 154.29deg 205.72deg,
      #00ffff 205.72deg 257.15deg,
      #ff00ff 257.15deg 308.58deg,
      #555555 308.58deg 360deg
    );
  }

  .pointer {
    position: absolute;
    top: -18px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 14px solid transparent;
    border-right: 14px solid transparent;
    border-bottom: 24px solid red;
    z-index: 2;
  }

  button {
    margin: 10px;
    padding: 14px 40px;
    font-size: 20px;
    font-weight: bold;
    border: none;
    border-radius: 10px;
    background: #ff004f;
    color: #fff;
    cursor: pointer;
  }

  .result {
    font-size: 22px;
    min-height: 30px;
    transition: all 0.3s ease;
  }

  .common { color:#b0ffb0; text-shadow:0 0 8px rgba(176,255,176,.6); }
  .rare { color:#b084ff; text-shadow:0 0 14px rgba(176,132,255,.9); }
  .legendary { color:gold; text-shadow:0 0 12px gold,0 0 30px orange; animation:pulse 1.2s infinite alternate; }
  .death-glow { color:#ff4d4d; text-shadow:0 0 15px red,0 0 35px darkred; animation:breathe 1.5s infinite; }

  @keyframes pulse { from { text-shadow:0 0 12px gold; } to { text-shadow:0 0 40px orange; } }
  @keyframes breathe { 0%,100%{opacity:.6} 50%{opacity:1} }

  .death { animation: shake .5s infinite; background: darkred; }
  @keyframes shake {
    0% { transform: translate(0); }
    25% { transform: translate(-5px, 5px); }
    50% { transform: translate(5px, -5px); }
    75% { transform: translate(-5px, -5px); }
    100% { transform: translate(0); }
  }

  .money {
    position: absolute;
    top: -50px;
    font-size: 24px;
    animation: fall linear forwards;
  }
  @keyframes fall { to { transform: translateY(110vh); } }

  .history,.leaderboard {
    width:90%;
    max-width:350px;
    max-height:120px;
    overflow-y:auto;
    font-size:14px;
    border-top:1px solid #444;
    margin-top:5px;
    padding-top:5px;
  }

  .slider { font-size:14px; margin-bottom:5px; }

</style>
</head>

<body>

<!-- Mascot with speech bubble -->
<div class="mascot">
  <div class="speech-bubble">
    Hey there! Ready to test your luck? Spin the wheel and let luck decide your fate!
  </div>
  <div class="mascot-img">üë©‚Äçüé§</div>
</div>

<h1>Spin the Wheel</h1>

<div class="slider">
  Death Probability: <span id="deathValue">5</span>%
  <input type="range" min="1" max="30" value="5" id="deathSlider">
</div>

<div class="wheel-container">
  <div class="pointer"></div>
  <div class="wheel" id="wheel">
    <div class="labels">
      <div>500k ‚Ç¨</div>
      <div>1 Mio ‚Ç¨</div>
      <div>10 Mio ‚Ç¨</div>
      <div>100 Mio ‚Ç¨</div>
      <div>1 Bil ‚Ç¨</div>
      <div>10 Bil ‚Ç¨</div>
      <div>üíÄ Death</div>
    </div>
  </div>
</div>

<button onclick="spin()">SPIN</button>

<div class="result" id="result"></div>
<div class="history" id="history"></div>
<div class="leaderboard" id="leaderboard"></div>

<!-- Sounds -->
<audio id="spinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-fast-small-sweep-transition-166.wav"></audio>
<audio id="tickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-mechanical-bling-210.wav"></audio>
<audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.wav"></audio>
<audio id="deathSound" src="https://assets.mixkit.co/sfx/preview/mixkit-creepy-ambience-1910.wav"></audio>

<script>
  const outcomes=["500k ‚Ç¨","1 Mio ‚Ç¨","10 Mio ‚Ç¨","100 Mio ‚Ç¨","1 Bil ‚Ç¨","10 Bil ‚Ç¨","üíÄ Death"];
  const historyEl=document.getElementById("history");
  const leaderboardEl=document.getElementById("leaderboard");
  const resultEl=document.getElementById("result");
  const slider=document.getElementById("deathSlider");
  const deathValue=document.getElementById("deathValue");
  const wheel=document.getElementById("wheel");
  const tickSound=document.getElementById("tickSound");

  slider.oninput = ()=> deathValue.textContent = slider.value;
  let rotation = 0;

  function vibrate(p){navigator.vibrate && navigator.vibrate(p)}

  function classify(outcome){
    if(outcome.includes("Death")) return "death-glow";
    if(outcome.includes("Bil")) return "legendary";
    if(outcome.includes("100")) return "rare";
    return "common";
  }

  function moneyRain(){
    for(let i=0;i<20;i++){
      const m=document.createElement("div");
      m.className="money";
      m.textContent="üí∞";
      m.style.left=Math.random()*100+"vw";
      m.style.animationDuration=(Math.random()*2+2)+"s";
      document.body.appendChild(m);
      setTimeout(()=>m.remove(),4000);
    }
  }

  function updateLeaderboard(outcome){
    const data=JSON.parse(localStorage.getItem("leaderboard")||"{}");
    data[outcome]=(data[outcome]||0)+1;
    localStorage.setItem("leaderboard",JSON.stringify(data));
    leaderboardEl.innerHTML="<b>Leaderboard</b><br>"+
      Object.entries(data).sort((a,b)=>b[1]-a[1])
      .map(([k,v])=>`${k}: ${v}`).join("<br>");
  }

  function spin(){
    resultEl.className="result";
    document.body.classList.remove("death");
    document.getElementById("spinSound").play();
    vibrate([100,50,100]);

    let ticks=0;
    const tickInterval=setInterval(()=>{
      tickSound.currentTime=0;
      tickSound.play();
      ticks++;
      if(ticks>10) clearInterval(tickInterval);
    },220 + ticks*35);

    // Decide outcome respecting death probability slider
    let outcome;
    if(Math.random()*100 < slider.value){
      outcome="üíÄ Death";
    } else {
      outcome = outcomes[Math.floor(Math.random()*6)]; // first 6 non-death
    }

    // Calculate wheel rotation for correct pointer
    const index = outcomes.indexOf(outcome);
    const sliceDeg = 360 / outcomes.length; // 360 / 7 = ~51.43
    const randomOffset = Math.random() * sliceDeg * 0.8;
    const targetRotation = 360*5 + 270 - index*sliceDeg - randomOffset;
    rotation += targetRotation;

    wheel.style.transition="transform 5.8s cubic-bezier(.12,.82,.08,1)";
    wheel.style.transform=`rotate(${rotation}deg)`;

    setTimeout(()=>{
      if(outcome.includes("Death")){
        document.body.classList.add("death");
        document.getElementById("deathSound").play();
        vibrate([300,100,300]);
      } else {
        document.getElementById("winSound").play();
        vibrate([150]);
        if(outcome.includes("Bil")||outcome.includes("100")) moneyRain();
      }

      const rarity = classify(outcome);
      resultEl.textContent="Result: "+outcome;
      resultEl.classList.add(rarity);
      historyEl.innerHTML=`‚Ä¢ ${outcome}<br>`+historyEl.innerHTML;
      updateLeaderboard(outcome);
    },5800);
  }

  updateLeaderboard("‚Äî");
</script>
</body>
</html>
